generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["multiSchema"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  schemas  = ["auth", "public"]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model audit_log_entries {
  instance_id String?   @db.Uuid
  id          String    @id @db.Uuid
  payload     Json?     @db.Json
  created_at  DateTime? @db.Timestamptz(6)
  ip_address  String    @default("") @db.VarChar(64)

  @@index([instance_id], map: "audit_logs_instance_id_idx")
  @@schema("auth")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model flow_state {
  id                     String                @id @db.Uuid
  user_id                String?               @db.Uuid
  auth_code              String
  code_challenge_method  code_challenge_method
  code_challenge         String
  provider_type          String
  provider_access_token  String?
  provider_refresh_token String?
  created_at             DateTime?             @db.Timestamptz(6)
  updated_at             DateTime?             @db.Timestamptz(6)
  authentication_method  String
  auth_code_issued_at    DateTime?             @db.Timestamptz(6)
  saml_relay_states      saml_relay_states[]

  @@index([created_at(sort: Desc)])
  @@index([auth_code], map: "idx_auth_code")
  @@index([user_id, authentication_method], map: "idx_user_id_auth_method")
  @@schema("auth")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model identities {
  provider_id     String
  user_id         String    @db.Uuid
  identity_data   Json
  provider        String
  last_sign_in_at DateTime? @db.Timestamptz(6)
  created_at      DateTime? @db.Timestamptz(6)
  updated_at      DateTime? @db.Timestamptz(6)
  email           String?   @default(dbgenerated("lower((identity_data ->> 'email'::text))"))
  id              String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  users           users     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([provider_id, provider], map: "identities_provider_id_provider_unique")
  @@index([email])
  @@index([user_id])
  @@schema("auth")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model instances {
  id              String    @id @db.Uuid
  uuid            String?   @db.Uuid
  raw_base_config String?
  created_at      DateTime? @db.Timestamptz(6)
  updated_at      DateTime? @db.Timestamptz(6)

  @@schema("auth")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model mfa_amr_claims {
  session_id            String   @db.Uuid
  created_at            DateTime @db.Timestamptz(6)
  updated_at            DateTime @db.Timestamptz(6)
  authentication_method String
  id                    String   @id(map: "amr_id_pk") @db.Uuid
  sessions              sessions @relation(fields: [session_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([session_id, authentication_method], map: "mfa_amr_claims_session_id_authentication_method_pkey")
  @@schema("auth")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model mfa_challenges {
  id                     String      @id @db.Uuid
  factor_id              String      @db.Uuid
  created_at             DateTime    @db.Timestamptz(6)
  verified_at            DateTime?   @db.Timestamptz(6)
  ip_address             String      @db.Inet
  otp_code               String?
  web_authn_session_data Json?
  mfa_factors            mfa_factors @relation(fields: [factor_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "mfa_challenges_auth_factor_id_fkey")

  @@index([created_at(sort: Desc)], map: "mfa_challenge_created_at_idx")
  @@schema("auth")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model mfa_factors {
  id                           String           @id @db.Uuid
  user_id                      String           @db.Uuid
  friendly_name                String?
  factor_type                  factor_type
  status                       factor_status
  created_at                   DateTime         @db.Timestamptz(6)
  updated_at                   DateTime         @db.Timestamptz(6)
  secret                       String?
  phone                        String?
  last_challenged_at           DateTime?        @unique @db.Timestamptz(6)
  web_authn_credential         Json?
  web_authn_aaguid             String?          @db.Uuid
  last_webauthn_challenge_data Json?
  mfa_challenges               mfa_challenges[]
  users                        users            @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, phone], map: "unique_phone_factor_per_user")
  @@index([user_id, created_at], map: "factor_id_created_at_idx")
  @@index([user_id])
  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model oauth_authorizations {
  id                    String                     @id @db.Uuid
  authorization_id      String                     @unique
  client_id             String                     @db.Uuid
  user_id               String?                    @db.Uuid
  redirect_uri          String
  scope                 String
  state                 String?
  resource              String?
  code_challenge        String?
  code_challenge_method code_challenge_method?
  response_type         oauth_response_type        @default(code)
  status                oauth_authorization_status @default(pending)
  authorization_code    String?                    @unique
  created_at            DateTime                   @default(now()) @db.Timestamptz(6)
  expires_at            DateTime                   @default(dbgenerated("(now() + '00:03:00'::interval)")) @db.Timestamptz(6)
  approved_at           DateTime?                  @db.Timestamptz(6)
  nonce                 String?
  oauth_clients         oauth_clients              @relation(fields: [client_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users                 users?                     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@schema("auth")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model oauth_client_states {
  id            String   @id @db.Uuid
  provider_type String
  code_verifier String?
  created_at    DateTime @db.Timestamptz(6)

  @@index([created_at], map: "idx_oauth_client_states_created_at")
  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model oauth_clients {
  id                   String                  @id @db.Uuid
  client_secret_hash   String?
  registration_type    oauth_registration_type
  redirect_uris        String
  grant_types          String
  client_name          String?
  client_uri           String?
  logo_uri             String?
  created_at           DateTime                @default(now()) @db.Timestamptz(6)
  updated_at           DateTime                @default(now()) @db.Timestamptz(6)
  deleted_at           DateTime?               @db.Timestamptz(6)
  client_type          oauth_client_type       @default(confidential)
  oauth_authorizations oauth_authorizations[]
  oauth_consents       oauth_consents[]
  sessions             sessions[]

  @@index([deleted_at])
  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model oauth_consents {
  id            String        @id @db.Uuid
  user_id       String        @db.Uuid
  client_id     String        @db.Uuid
  scopes        String
  granted_at    DateTime      @default(now()) @db.Timestamptz(6)
  revoked_at    DateTime?     @db.Timestamptz(6)
  oauth_clients oauth_clients @relation(fields: [client_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users         users         @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, client_id], map: "oauth_consents_user_client_unique")
  @@index([user_id, granted_at(sort: Desc)], map: "oauth_consents_user_order_idx")
  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model one_time_tokens {
  id         String              @id @db.Uuid
  user_id    String              @db.Uuid
  token_type one_time_token_type
  token_hash String
  relates_to String
  created_at DateTime            @default(now()) @db.Timestamp(6)
  updated_at DateTime            @default(now()) @db.Timestamp(6)
  users      users               @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, token_type])
  @@index([relates_to], map: "one_time_tokens_relates_to_hash_idx", type: Hash)
  @@index([token_hash], map: "one_time_tokens_token_hash_hash_idx", type: Hash)
  @@schema("auth")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model refresh_tokens {
  instance_id String?   @db.Uuid
  id          BigInt    @id @default(autoincrement())
  token       String?   @unique(map: "refresh_tokens_token_unique") @db.VarChar(255)
  user_id     String?   @db.VarChar(255)
  revoked     Boolean?
  created_at  DateTime? @db.Timestamptz(6)
  updated_at  DateTime? @db.Timestamptz(6)
  parent      String?   @db.VarChar(255)
  session_id  String?   @db.Uuid
  sessions    sessions? @relation(fields: [session_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([instance_id])
  @@index([instance_id, user_id])
  @@index([parent])
  @@index([session_id, revoked])
  @@index([updated_at(sort: Desc)])
  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model saml_providers {
  id                String        @id @db.Uuid
  sso_provider_id   String        @db.Uuid
  entity_id         String        @unique
  metadata_xml      String
  metadata_url      String?
  attribute_mapping Json?
  created_at        DateTime?     @db.Timestamptz(6)
  updated_at        DateTime?     @db.Timestamptz(6)
  name_id_format    String?
  sso_providers     sso_providers @relation(fields: [sso_provider_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([sso_provider_id])
  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model saml_relay_states {
  id              String        @id @db.Uuid
  sso_provider_id String        @db.Uuid
  request_id      String
  for_email       String?
  redirect_to     String?
  created_at      DateTime?     @db.Timestamptz(6)
  updated_at      DateTime?     @db.Timestamptz(6)
  flow_state_id   String?       @db.Uuid
  flow_state      flow_state?   @relation(fields: [flow_state_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  sso_providers   sso_providers @relation(fields: [sso_provider_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([created_at(sort: Desc)])
  @@index([for_email])
  @@index([sso_provider_id])
  @@schema("auth")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model schema_migrations {
  version String @id @db.VarChar(255)

  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model sessions {
  id                     String           @id @db.Uuid
  user_id                String           @db.Uuid
  created_at             DateTime?        @db.Timestamptz(6)
  updated_at             DateTime?        @db.Timestamptz(6)
  factor_id              String?          @db.Uuid
  aal                    aal_level?
  not_after              DateTime?        @db.Timestamptz(6)
  refreshed_at           DateTime?        @db.Timestamp(6)
  user_agent             String?
  ip                     String?          @db.Inet
  tag                    String?
  oauth_client_id        String?          @db.Uuid
  refresh_token_hmac_key String?
  refresh_token_counter  BigInt?
  scopes                 String?
  mfa_amr_claims         mfa_amr_claims[]
  refresh_tokens         refresh_tokens[]
  oauth_clients          oauth_clients?   @relation(fields: [oauth_client_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users                  users            @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([not_after(sort: Desc)])
  @@index([oauth_client_id])
  @@index([user_id])
  @@index([user_id, created_at], map: "user_id_created_at_idx")
  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model sso_domains {
  id              String        @id @db.Uuid
  sso_provider_id String        @db.Uuid
  domain          String
  created_at      DateTime?     @db.Timestamptz(6)
  updated_at      DateTime?     @db.Timestamptz(6)
  sso_providers   sso_providers @relation(fields: [sso_provider_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([sso_provider_id])
  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model sso_providers {
  id                String              @id @db.Uuid
  resource_id       String?
  created_at        DateTime?           @db.Timestamptz(6)
  updated_at        DateTime?           @db.Timestamptz(6)
  disabled          Boolean?
  saml_providers    saml_providers[]
  saml_relay_states saml_relay_states[]
  sso_domains       sso_domains[]

  @@index([resource_id], map: "sso_providers_resource_id_pattern_idx")
  @@schema("auth")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model users {
  instance_id                 String?                @db.Uuid
  id                          String                 @id @db.Uuid
  aud                         String?                @db.VarChar(255)
  role                        String?                @db.VarChar(255)
  email                       String?                @db.VarChar(255)
  encrypted_password          String?                @db.VarChar(255)
  email_confirmed_at          DateTime?              @db.Timestamptz(6)
  invited_at                  DateTime?              @db.Timestamptz(6)
  confirmation_token          String?                @db.VarChar(255)
  confirmation_sent_at        DateTime?              @db.Timestamptz(6)
  recovery_token              String?                @db.VarChar(255)
  recovery_sent_at            DateTime?              @db.Timestamptz(6)
  email_change_token_new      String?                @db.VarChar(255)
  email_change                String?                @db.VarChar(255)
  email_change_sent_at        DateTime?              @db.Timestamptz(6)
  last_sign_in_at             DateTime?              @db.Timestamptz(6)
  raw_app_meta_data           Json?
  raw_user_meta_data          Json?
  is_super_admin              Boolean?
  created_at                  DateTime?              @db.Timestamptz(6)
  updated_at                  DateTime?              @db.Timestamptz(6)
  phone                       String?                @unique
  phone_confirmed_at          DateTime?              @db.Timestamptz(6)
  phone_change                String?                @default("")
  phone_change_token          String?                @default("") @db.VarChar(255)
  phone_change_sent_at        DateTime?              @db.Timestamptz(6)
  confirmed_at                DateTime?              @default(dbgenerated("LEAST(email_confirmed_at, phone_confirmed_at)")) @db.Timestamptz(6)
  email_change_token_current  String?                @default("") @db.VarChar(255)
  email_change_confirm_status Int?                   @default(0) @db.SmallInt
  banned_until                DateTime?              @db.Timestamptz(6)
  reauthentication_token      String?                @default("") @db.VarChar(255)
  reauthentication_sent_at    DateTime?              @db.Timestamptz(6)
  is_sso_user                 Boolean                @default(false)
  deleted_at                  DateTime?              @db.Timestamptz(6)
  is_anonymous                Boolean                @default(false)
  identities                  identities[]
  mfa_factors                 mfa_factors[]
  oauth_authorizations        oauth_authorizations[]
  oauth_consents              oauth_consents[]
  one_time_tokens             one_time_tokens[]
  sessions                    sessions[]
  AuthLogs                    AuthLogs[]
  MinutasDefinitivas          MinutasDefinitivas[]
  Profiles                    Profiles?

  @@index([instance_id])
  @@index([is_anonymous])
  @@schema("auth")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model tablas {
  id                                Int        @id @db.SmallInt
  natdelproyecto                    String?
  etapa                             String?
  tipo                              String?
  sectorid                          String
  edificiotorre                     String?
  piso                              String?
  nrounidad                         String?
  dormitorios                       String?
  frente                            String?
  manzana                           String?
  destino                           String?
  tipocochera                       String?
  tamano                            String?
  m2cubiertos                       Float?
  m2semicubiertos                   Float?
  m2exclusivos                      Float?
  m2patioterraza                    Float?
  patioterraza                      String?
  m2comunes                         Float?
  m2calculo                         Float?
  m2totales                         Float?
  preciousd                         Float?
  usdm2                             Float?
  estado                            String?
  motivonodisp                      String?
  obs                               String?
  fechareserva                      String?
  comercial                         String?
  clienteinteresado                 String?
  fechafirmaboleto                  String?
  clientetitularboleto              String?
  fechaposesionporboletocompraventa String?
  deptocomprador                    String?
  proyecto_id                       String?    @db.Uuid
  proyectos                         Proyectos? @relation(fields: [proyecto_id], references: [Id], onDelete: NoAction)

  @@index([estado], map: "idx_tablas_estado")
  @@index([natdelproyecto], map: "idx_tablas_natdelproyecto")
  @@index([natdelproyecto, estado], map: "idx_tablas_natdelproyecto_estado")
  @@index([natdelproyecto, nrounidad], map: "idx_tablas_natdelproyecto_nrounidad")
  @@index([nrounidad], map: "idx_tablas_nrounidad")
  @@index([proyecto_id], map: "idx_tablas_proyecto_id")
  @@index([sectorid], map: "idx_tablas_sectorid")
  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Clientes {
  Id                        String                      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  NombreApellido            String?
  Telefono                  String?                     @default("")
  Dni                       BigInt?                     @unique(map: "Clientes_dni_key")
  UnidadesInteresadas       Json?                       @db.Json
  ClientesUnidadesTitulares ClientesUnidadesTitulares[]
  DetallesVenta             DetallesVenta[]

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model ClientesUnidadesTitulares {
  IdCliente  String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  IdUnidad   String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  Porcentaje Float?   @db.Real
  Clientes   Clientes @relation(fields: [IdCliente], references: [Id], onDelete: NoAction)
  Unidades   Unidades @relation(fields: [IdUnidad], references: [Id], onDelete: Cascade)

  @@id([IdCliente, IdUnidad])
  @@schema("public")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model AuthLogs {
  Id        String   @id(map: "auth_logs_pkey") @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  UserId    String?  @db.Uuid
  Email     String?
  EventType String
  Timestamp DateTime @default(now()) @db.Timestamptz(6)
  Detail    Json?
  UserAgent String?
  CreatedAt DateTime @default(now()) @db.Timestamptz(6)
  users     users?   @relation(fields: [UserId], references: [id], onUpdate: NoAction, map: "auth_logs_user_id_fkey")

  @@index([EventType], map: "idx_auth_logs_event_type")
  @@index([Timestamp], map: "idx_auth_logs_timestamp")
  @@index([UserId], map: "idx_auth_logs_user_id")
  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model ChangesLogs {
  Id            BigInt   @id(map: "changes_logs_pkey") @default(autoincrement())
  CreatedAt     DateTime @default(now()) @db.Timestamptz(6)
  Motivo        String?
  Descripcion   String?
  Impacto       String?
  TablaAfectada String?
  UsuarioId     String   @db.Uuid
  UsuarioMail   String
  Profiles      Profiles @relation(fields: [UsuarioId], references: [Id], onDelete: SetNull, onUpdate: NoAction, map: "changes_logs_usuarioID_fkey")

  @@schema("public")
}

model Comerciales {
  Id            String          @id(map: "comerciales_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  Nombre        String          @unique(map: "comerciales_nombre_key") @db.VarChar(255)
  DetallesVenta DetallesVenta[]

  @@schema("public")
}

model DetallesVenta {
  UnidadId                                           String           @id(map: "detallesventa_pkey") @db.Uuid
  EstadoId                                           String?          @db.Uuid
  ComercialId                                        String?          @db.Uuid
  MotivoNoDispId                                     String?          @db.Uuid
  PrecioUsd                                          Decimal?         @db.Decimal(12, 2)
  UsdM2                                              Decimal?         @db.Decimal(10, 2)
  FechaReserva                                       DateTime?        @db.Date
  FechaFirmaBoleto                                   DateTime?        @db.Date
  FechaPosesion                                      DateTime?        @db.Date
  Obs                                                String?
  TipoCocheraId                                      String?          @db.Uuid
  UnidadCompradorId                                  String?          @db.Uuid
  Titular                                            String?
  FechaPisada                                        DateTime?        @db.Date
  ClienteInteresado                                  String?          @db.Uuid
  Clientes                                           Clientes?        @relation(fields: [ClienteInteresado], references: [Id], map: "detallesventa_clienteInteresado_fkey")
  Comerciales                                        Comerciales?     @relation(fields: [ComercialId], references: [Id], onDelete: NoAction, onUpdate: NoAction, map: "detallesventa_comercial_id_fkey")
  EstadoComercial                                    EstadoComercial? @relation(fields: [EstadoId], references: [Id], onDelete: NoAction, onUpdate: NoAction, map: "detallesventa_estado_id_fkey")
  MotivosNoDisp                                      MotivosNoDisp?   @relation(fields: [MotivoNoDispId], references: [Id], onDelete: NoAction, onUpdate: NoAction, map: "detallesventa_motivoid_fkey")
  Unidades_DetallesVenta_UnidadIdToUnidades          Unidades         @relation("DetallesVenta_UnidadIdToUnidades", fields: [UnidadId], references: [Id], onDelete: NoAction, onUpdate: NoAction, map: "detallesventa_unidad_id_fkey")
  TiposCochera                                       TiposCochera?    @relation(fields: [TipoCocheraId], references: [Id], onDelete: NoAction, onUpdate: NoAction, map: "fk_tipocochera")
  Unidades_DetallesVenta_UnidadCompradorIdToUnidades Unidades?        @relation("DetallesVenta_UnidadCompradorIdToUnidades", fields: [UnidadCompradorId], references: [Id], onDelete: NoAction, onUpdate: NoAction, map: "fk_unidad_comprador")

  @@schema("public")
}

model Edificios {
  Id             String     @id(map: "edificios_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  ProyectoId     String     @db.Uuid
  NombreEdificio String     @db.VarChar(50)
  Proyectos      Proyectos  @relation(fields: [ProyectoId], references: [Id], onDelete: NoAction, onUpdate: NoAction, map: "edificios_proyecto_id_fkey")
  Unidades       Unidades[]

  @@schema("public")
}

model EstadoComercial {
  Id            String          @id(map: "estadocomercial_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  NombreEstado  String          @unique(map: "estadocomercial_nombreestado_key") @db.VarChar(100)
  DetallesVenta DetallesVenta[]

  @@schema("public")
}

model Etapas {
  Id       String     @id(map: "etapas_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  Nombre   String     @unique(map: "etapas_nombre_key") @db.VarChar(100)
  Unidades Unidades[]

  @@schema("public")
}

model GastosGenerales {
  Proyecto             String    @db.Uuid
  Sellado              Float?
  CertificacionDeFirma Float?
  Alajamiento          Float?
  PlanoM2Propiedad     Float?
  PlanoM2Cochera       Float?
  ComisionInmobiliaria Float?
  OtroGasto            Float?
  CreatedAt            DateTime? @default(now()) @db.Timestamptz(6)
  FechaPosesion        String?
  EtapaTorre           String?
  Id                   String    @id(map: "gastosgenerales_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  Proyectos            Proyectos @relation(fields: [Proyecto], references: [Id], onDelete: NoAction, onUpdate: NoAction, map: "gastosgenerales_proyecto_fkey")

  @@schema("public")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model MinutasDefinitivas {
  Id                String     @id(map: "minutas_definitivas_pkey") @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  UsuarioId         String     @db.Uuid
  FechaCreacion     DateTime?  @default(now()) @db.Timestamptz(6)
  Dato              Json
  DatoAdicional     Json?
  Estado            String
  UrlDocumento      String?
  CreatedAt         DateTime?  @default(now()) @db.Timestamptz(6)
  UpdatedAt         DateTime?  @default(now()) @db.Timestamptz(6)
  Comentario        String?
  DatoMapaVenta     Json?
  Proyecto          String?    @db.Uuid
  Version           Int        @default(1)
  Motivo            String?
  ClienteInteresado BigInt?
  Proyectos         Proyectos? @relation(fields: [Proyecto], references: [Id], onDelete: NoAction, onUpdate: NoAction, map: "minutas_definitivas_proyecto_fkey")
  users             users      @relation(fields: [UsuarioId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "minutas_definitivas_usuario_id_fkey")

  @@index([CreatedAt(sort: Desc)], map: "idx_minutas_definitivas_created_at")
  @@index([Estado], map: "idx_minutas_definitivas_estado")
  @@index([FechaCreacion(sort: Desc)], map: "idx_minutas_definitivas_fecha_creacion")
  @@index([Proyecto], map: "idx_minutas_definitivas_proyecto")
  @@index([Proyecto, Estado, FechaCreacion(sort: Desc)], map: "idx_minutas_definitivas_proyecto_estado_fecha")
  @@index([UsuarioId, Estado], map: "idx_minutas_definitivas_usuario_estado")
  @@index([UsuarioId], map: "idx_minutas_definitivas_usuario_id")
  @@index([Estado], map: "idx_minutas_estado")
  @@index([UsuarioId], map: "idx_minutas_usuario")
  @@schema("public")
}

model MotivosNoDisp {
  Id            String          @id(map: "motivosnodisp_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  Nombre        String          @unique(map: "motivosnodisp_nombre_key") @db.VarChar(255)
  DetallesVenta DetallesVenta[]

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Naturalezas {
  Id        String      @id(map: "naturalezas_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  Nombre    String?
  CreatedAt DateTime    @default(now()) @db.Timestamptz(6)
  Proyectos Proyectos[]

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Organizaciones {
  Id        String      @id(map: "organizaciones_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  Nombre    String?
  Creador   String?     @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  CreatedAt DateTime    @default(now()) @db.Timestamptz(6)
  Proyectos Proyectos[]

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Permisos {
  Id            String          @id(map: "permissions_pkey") @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  CreatedAt     DateTime?       @default(now()) @db.Timestamptz(6)
  UpdatedAt     DateTime?       @default(now()) @db.Timestamptz(6)
  Nombre        String?
  Descripcion   String?
  RolesPermisos RolesPermisos[]

  @@index([Nombre], map: "idx_permisos_nombre")
  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model PermisosExtras {
  IdRolUsuario String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  CreatedAt    DateTime @default(now()) @db.Timestamptz(6)
  IdPermiso    String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  Descripcion  String?

  @@id([IdRolUsuario, IdPermiso], map: "permisos-extras_pkey")
  @@index([IdPermiso], map: "idx_permisos_extras_idpermiso")
  @@index([IdRolUsuario], map: "idx_permisos_extras_idrolusuario")
  @@schema("public")
}

model Profiles {
  Id                    String              @id(map: "profiles_pkey") @db.Uuid
  Email                 String
  Nombre                String?
  Apellido              String?
  Activo                Boolean?            @default(true)
  CreatedAt             DateTime?           @default(now()) @db.Timestamptz(6)
  UpdatedAt             DateTime?           @default(now()) @db.Timestamptz(6)
  RequirePasswordChange Boolean?            @default(true)
  FirstLogin            Boolean?            @default(true)
  ChangesLogs           ChangesLogs[]
  users                 users               @relation(fields: [Id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "profiles_id_fkey")
  UsuariosProyectos     UsuariosProyectos[]
  UsuariosRoles         UsuariosRoles[]

  @@index([Activo], map: "idx_profiles_activo")
  @@index([Email], map: "idx_profiles_email")
  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model Proyectos {
  Id                   String                 @id(map: "proyectos_pkey") @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  Nombre               String                 @unique(map: "proyectos_nombre_key")
  TablaNombre          String
  Descripcion          String?
  Direccion            String?
  Localidad            String?
  Provincia            String?
  Activo               Boolean?               @default(true)
  CreatedAt            DateTime?              @default(now()) @db.Timestamptz(6)
  UpdatedAt            DateTime?              @default(now()) @db.Timestamptz(6)
  Naturaleza           String?                @db.Uuid
  IdOrg                String?                @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  Iva                  String?
  Edificios            Edificios[]
  GastosGenerales      GastosGenerales[]
  MinutasDefinitivas   MinutasDefinitivas[]
  Organizaciones       Organizaciones?        @relation(fields: [IdOrg], references: [Id], onDelete: NoAction, onUpdate: NoAction, map: "proyectos_id_org_fkey")
  Naturalezas          Naturalezas?           @relation(fields: [Naturaleza], references: [Id], onUpdate: NoAction, map: "proyectos_naturaleza_fkey")
  ProyectosTiposUnidad ProyectosTiposUnidad[]
  UsuariosProyectos    UsuariosProyectos[]
  tablas               tablas[]
  SnapshotsStock       SnapshotsStock[]

  @@index([Activo], map: "idx_proyectos_activo")
  @@schema("public")
}

model ProyectosTiposUnidad {
  Id           String      @id(map: "proyectostiposunidad_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  ProyectoId   String      @db.Uuid
  TipoUnidadId String      @db.Uuid
  CreatedAt    DateTime?   @default(now()) @db.Timestamp(6)
  Proyectos    Proyectos   @relation(fields: [ProyectoId], references: [Id], onDelete: Cascade, onUpdate: NoAction, map: "proyectostiposunidad_proyecto_id_fkey")
  TiposUnidad  TiposUnidad @relation(fields: [TipoUnidadId], references: [Id], onDelete: Cascade, onUpdate: NoAction, map: "proyectostiposunidad_tipounidad_id_fkey")

  @@unique([ProyectoId, TipoUnidadId], map: "proyectostiposunidad_proyecto_id_tipounidad_id_key")
  @@schema("public")
}

model Roles {
  Id                String              @id(map: "roles_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  Nombre            String              @default("")
  CreatedAt         DateTime            @default(now()) @db.Timestamptz(6)
  RolesPermisos     RolesPermisos[]
  UsuariosProyectos UsuariosProyectos[]
  UsuariosRoles     UsuariosRoles[]

  @@index([Nombre], map: "idx_roles_nombre")
  @@schema("public")
}

model RolesPermisos {
  IdRol     String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  IdPermiso String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  CreatedAt DateTime @default(now()) @db.Timestamptz(6)
  Permisos  Permisos @relation(fields: [IdPermiso], references: [Id], onDelete: NoAction, map: "roles-permisos_idpermiso_fkey")
  Roles     Roles    @relation(fields: [IdRol], references: [Id], onDelete: NoAction, map: "roles-permisos_idrol_fkey")

  @@id([IdRol, IdPermiso], map: "roles-permisos_pkey")
  @@index([IdPermiso], map: "idx_roles_permisos_idpermiso")
  @@index([IdRol], map: "idx_roles_permisos_idrol")
  @@schema("public")
}

model TiposCochera {
  Id            String          @id(map: "tiposcochera_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  Nombre        String          @unique(map: "tiposcochera_nombre_key") @db.VarChar(100)
  DetallesVenta DetallesVenta[]

  @@schema("public")
}

model TiposPatioTerraza {
  Id               String             @id(map: "tipospatioterraza_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  Nombre           String             @unique(map: "tipospatioterraza_nombre_key") @db.VarChar(100)
  UnidadesMetricas UnidadesMetricas[]

  @@schema("public")
}

model TiposUnidad {
  Id                   String                 @id(map: "tiposunidad_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  Nombre               String                 @unique(map: "tiposunidad_nombre_key") @db.VarChar(100)
  ProyectosTiposUnidad ProyectosTiposUnidad[]
  Unidades             Unidades[]

  @@schema("public")
}

model Unidades {
  Id                                                      String                      @id(map: "unidades_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  EdificioId                                              String?                     @db.Uuid
  TipoUnidadId                                            String                      @db.Uuid
  EtapaId                                                 String?                     @db.Uuid
  SectorId                                                String                      @unique(map: "unidades_sectorid_key")
  Piso                                                    String?                     @db.VarChar(50)
  NroUnidad                                               String?                     @db.VarChar(50)
  Dormitorio                                              Int?
  Manzana                                                 String?                     @db.VarChar(50)
  Destino                                                 String?                     @db.VarChar(100)
  Frente                                                  String?                     @db.VarChar
  ClientesUnidadesTitulares                               ClientesUnidadesTitulares[]
  DetallesVenta_DetallesVenta_UnidadIdToUnidades          DetallesVenta?              @relation("DetallesVenta_UnidadIdToUnidades")
  DetallesVenta_DetallesVenta_UnidadCompradorIdToUnidades DetallesVenta[]             @relation("DetallesVenta_UnidadCompradorIdToUnidades")
  Edificios                                               Edificios?                  @relation(fields: [EdificioId], references: [Id], onDelete: NoAction, onUpdate: NoAction, map: "unidades_edificio_id_fkey")
  Etapas                                                  Etapas?                     @relation(fields: [EtapaId], references: [Id], onDelete: NoAction, onUpdate: NoAction, map: "unidades_etapa_id_fkey")
  TiposUnidad                                             TiposUnidad                 @relation(fields: [TipoUnidadId], references: [Id], onDelete: NoAction, onUpdate: NoAction, map: "unidades_tipounidad_id_fkey")
  UnidadesMetricas                                        UnidadesMetricas?

  @@index([EdificioId, TipoUnidadId], map: "idx_unidades_edificio_tipo")
  @@index([EtapaId], map: "idx_unidades_etapa_id")
  @@schema("public")
}

model UnidadesMetricas {
  UnidadId          String             @id(map: "unidadesmetricas_pkey") @db.Uuid
  M2Exclusivo       Decimal?           @db.Decimal(10, 2)
  M2PatioTerraza    Decimal?           @db.Decimal(10, 2)
  TipoPatioId       String?            @db.Uuid
  M2Comun           Decimal?           @db.Decimal(10, 2)
  M2Calculo         Decimal?           @db.Decimal(10, 2)
  M2Total           Decimal?           @db.Decimal(10, 2)
  M2Cubierto        Decimal?           @db.Decimal(10, 2)
  M2Semicubierto    Decimal?           @db.Decimal(10, 2)
  Tamano            String?
  TiposPatioTerraza TiposPatioTerraza? @relation(fields: [TipoPatioId], references: [Id], onDelete: NoAction, onUpdate: NoAction, map: "unidadesmetricas_tipopatio_id_fkey")
  Unidades          Unidades           @relation(fields: [UnidadId], references: [Id], onDelete: NoAction, onUpdate: NoAction, map: "unidadesmetricas_unidad_id_fkey")

  @@schema("public")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model UserExists {
  Exist Boolean?

  @@ignore
  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model UsuariosOrganizaciones {
  UserId    String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  IdOrg     String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  IdRol     String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  CreatedAt DateTime @default(now()) @db.Timestamptz(6)

  @@id([UserId, IdOrg, IdRol], map: "usuarios-organizaciones_pkey")
  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model UsuariosProyectos {
  IdUsuario  String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  IdProyecto String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  IdRol      String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  CreatedAt  DateTime  @default(now()) @db.Timestamptz(6)
  Proyectos  Proyectos @relation(fields: [IdProyecto], references: [Id], onDelete: NoAction, onUpdate: NoAction, map: "usuarios-proyectos_idproyecto_fkey")
  Roles      Roles     @relation(fields: [IdRol], references: [Id], onDelete: NoAction, map: "usuarios-proyectos_idrol_fkey")
  Profiles   Profiles  @relation(fields: [IdUsuario], references: [Id], onDelete: NoAction, map: "usuarios-proyectos_idusuario_fkey")

  @@id([IdUsuario, IdProyecto, IdRol], map: "usuarios-proyectos_pkey")
  @@index([IdProyecto], map: "idx_usuarios_proyectos_idproyecto")
  @@index([IdRol], map: "idx_usuarios_proyectos_idrol")
  @@index([IdUsuario], map: "idx_usuarios_proyectos_idusuario")
  @@index([IdUsuario], map: "idx_usuarios_proyectos_usuario")
  @@index([IdUsuario, IdProyecto], map: "idx_usuarios_proyectos_usuario_proyecto")
  @@schema("public")
}

model UsuariosRoles {
  IdUsuario String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  IdRol     String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  CreatedAt DateTime @default(now()) @db.Timestamptz(6)
  Roles     Roles    @relation(fields: [IdRol], references: [Id], onDelete: NoAction, map: "usuarios-roles_idrol_fkey")
  Profiles  Profiles @relation(fields: [IdUsuario], references: [Id], onDelete: NoAction, map: "usuarios-roles_idusuario_fkey")

  @@id([IdUsuario, IdRol], map: "usuarios-roles_pkey")
  @@index([IdRol], map: "idx_usuarios_roles_idrol")
  @@index([IdUsuario], map: "idx_usuarios_roles_idusuario")
  @@index([IdUsuario], map: "idx_usuarios_roles_usuario")
  @@schema("public")
}

enum aal_level {
  aal1
  aal2
  aal3

  @@schema("auth")
}

enum code_challenge_method {
  s256
  plain

  @@schema("auth")
}

enum factor_status {
  unverified
  verified

  @@schema("auth")
}

enum factor_type {
  totp
  webauthn
  phone

  @@schema("auth")
}

enum oauth_authorization_status {
  pending
  approved
  denied
  expired

  @@schema("auth")
}

enum oauth_client_type {
  public
  confidential

  @@schema("auth")
}

enum oauth_registration_type {
  dynamic
  manual

  @@schema("auth")
}

enum oauth_response_type {
  code

  @@schema("auth")
}

enum one_time_token_type {
  confirmation_token
  reauthentication_token
  recovery_token
  email_change_token_new
  email_change_token_current
  phone_change_token

  @@schema("auth")
}

// Stock History Models
model SnapshotsStock {
  Id              String                   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  FechaSnapshot   DateTime                 @db.Date
  TipoSnapshot    String                   @db.VarChar(20) // DIARIO, MENSUAL
  ProyectoId      String?                  @db.Uuid
  TotalUnidades   Int
  Disponibles     Int
  Reservadas      Int
  Vendidas        Int
  NoDisponibles   Int
  ValorStockUSD   Decimal?                 @db.Decimal(15, 2)
  M2TotalesStock  Decimal?                 @db.Decimal(15, 2)
  CreatedAt       DateTime                 @default(now()) @db.Timestamptz(6)

  Proyecto        Proyectos?               @relation(fields: [ProyectoId], references: [Id])
  Detalles        SnapshotsStockDetalle[]

  @@index([FechaSnapshot, ProyectoId])
  @@schema("public")
}

model SnapshotsStockDetalle {
  Id              String          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  SnapshotId      String          @db.Uuid
  UnidadId        String          @db.Uuid
  SectorId        String?         @db.VarChar(100)
  Proyecto        String?         @db.VarChar(200)
  Tipo            String?         @db.VarChar(100)
  Estado          String          @db.VarChar(50)
  PrecioUSD       Decimal?        @db.Decimal(15, 2)
  UsdM2           Decimal?        @db.Decimal(10, 2)
  EstadoAnterior  String?         @db.VarChar(50)
  DiasEnEstado    Int?

  Snapshot        SnapshotsStock  @relation(fields: [SnapshotId], references: [Id], onDelete: Cascade)

  @@index([SnapshotId])
  @@index([UnidadId])
  @@schema("public")
}
